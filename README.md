# DPS Filters project repo
This project is heavily based on the work of github user gavv. 
His github repo is [here](https://github.com/gavv/snippets/tree/master/decode_play)
See details in the [blog post](https://gavv.github.io/blog/decode-play/).

### Overview

This project implements a digital filter in the time domain in c++.
This is accomplished by implementing the difference equation directly.
For examples of this look at the AllpassFilter.{cpp,h} and FIRFilter.{cpp,h} files.
an output variable (y) is generated by using the input and delayed versions of an
intermediate variable. (This is a direct form 2 implementation, direct form 1 can
be used but it requires a second delay buffer.)

The project is split into three parts an audio decoding program (in ffmpeg_decode.cpp),
a playback program (ffmpeg_play.cpp), and the actual filter (FilterProject.{cpp,h}).

The decoding program outputs the raw samples from the audio file over stdout the filter program
takes the samples and filters them (well, duh) then again outputs them over stdout. Last, the 
playback program takes the samples and does magic on them so the linux audio system can play
it back.

One gotcha is that since the files are typically stereo left and right samples are interleaved.

Decoded samples are always in the same format:
* linear PCM;
* two channels (front Left, front Right);
* interleaved format (L R L R ...);
* samples are 16-bits sighed integers in little endian (actually CPU should be little-endian too);
* sample rate is 44100 Hz.


### Building

On the pi some packages need to be installed (this is the audio decoding library).
Connect the pi to the internet (via ethernet) then run
```
sudo apt install libavcodec-dev libavformat-dev libavdevice-dev
```

Next get into this directory and run
```
make
```
This will (hopefully) build all of the code needed to run your project.

### Usage

The decoder, filter, and playback programs must be connected via pipe.
(A pipe takes the output from stdout from one program and "pipes" it into
the input for another program.) To use your filter run the following command.

```
./ffmpeg_decode your_snazzy_audio_file.mp3 | ./ffmpeg_filter | ./ffmpeg_play
```

Note that the input audio file can be in almost any format.
